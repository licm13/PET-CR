---
marp: true
theme: default
paginate: true
backgroundColor: #fff
backgroundImage: url('https://marp.app/assets/hero-background.svg')
style: |
  section {
    font-size: 28px;
  }
  h1 {
    color: #2c5aa0;
  }
  h2 {
    color: #3a7bc8;
  }
  code {
    background: #f4f4f4;
  }
---

<!-- _class: lead -->

# PET-CR: ç»Ÿä¸€çš„è’¸æ•£å‘äº’è¡¥å…³ç³»æ¨¡å‹åº“

## Unified Complementary Relationship Evapotranspiration Library

**èåˆä¼ ç»Ÿæ¨¡å‹ã€é™†-æ°”æ¡†æ¶ä¸BGCR-Budykoæ–¹æ³•**
**Integrating Traditional Models, Land-Atmosphere Framework, and BGCR-Budyko Method**

v0.3.0 | 2025

---

<!-- _class: lead -->

# ç¬¬ä¸€éƒ¨åˆ†ï¼šç®€ä»‹
# Part 1: Introduction

ä»€ä¹ˆæ˜¯è’¸æ•£å‘ä¸äº’è¡¥å…³ç³»ï¼Ÿ
What are ET and Complementary Relationship?

---

## ä»€ä¹ˆæ˜¯è’¸æ•£å‘ (ET) ä¸äº’è¡¥å…³ç³» (CR)ï¼Ÿ

### åŸºæœ¬æ¦‚å¿µ / Basic Concepts

**è’¸æ•£å‘ (Evapotranspiration, ET)**
- æ°´åˆ†ä»åœ°è¡¨è’¸å‘å’Œæ¤è¢«è’¸è…¾çš„æ€»å’Œ
- è¿æ¥æ°´å¾ªç¯å’Œèƒ½é‡å¹³è¡¡çš„å…³é”®è¿‡ç¨‹

**ä¸¤ä¸ªå…³é”®å˜é‡ / Two Key Variables**
- **Ea** (Actual ET / å®é™…è’¸æ•£å‘): å®é™…å‘ç”Ÿçš„è’¸æ•£å‘
- **Ep** (Potential ET / æ½œåœ¨è’¸æ•£å‘): æ°´åˆ†å……è¶³æ—¶çš„æœ€å¤§è’¸æ•£å‘

---

## Bouchetäº’è¡¥å‡è¯´ (1963)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åœŸå£¤å˜å¹² (Soil drying)                              â”‚
â”‚         â†“                                             â”‚
â”‚  Ea â†“  (å®é™…è’¸æ•£å‘ä¸‹é™)                              â”‚
â”‚         â†“                                             â”‚
â”‚  æ›´å¤šèƒ½é‡åŠ çƒ­ç©ºæ°” (More energy heats air)            â”‚
â”‚         â†“                                             â”‚
â”‚  å¤§æ°”å¹²ç‡¥åº¦â†‘ (Atmospheric aridity â†‘)                 â”‚
â”‚         â†“                                             â”‚
â”‚  Ep â†‘  (æ½œåœ¨è’¸æ•£å‘ä¸Šå‡)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ ¸å¿ƒæ€æƒ³: Ea + Ep = å¸¸æ•° (åœ¨ç»™å®šæ°”è±¡æ¡ä»¶ä¸‹)
Core idea: Ea + Ep = constant (under given meteorological conditions)
```

---

## ä¸ºä»€ä¹ˆéœ€è¦äº’è¡¥å…³ç³»ï¼Ÿ

### ä¼ ç»Ÿé—®é¢˜ / Traditional Challenge

âŒ **ç›´æ¥æµ‹é‡Eaå›°éš¾**
- æ¶¡åº¦ç›¸å…³ç³»ç»Ÿæ˜‚è´µ
- ç©ºé—´è¦†ç›–æœ‰é™
- é•¿æœŸç»´æŠ¤å›°éš¾

âœ… **CRçš„è§£å†³æ–¹æ¡ˆ**
- åˆ©ç”¨å¸¸è§„æ°”è±¡æ•°æ®
- é€šè¿‡Epä¼°ç®—Ea
- ç†è®ºä¸è§‚æµ‹ç›¸ç»“åˆ

---

<!-- _class: lead -->

# ç¬¬äºŒéƒ¨åˆ†ï¼šPET-CRåº“æ¦‚è§ˆ
# Part 2: PET-CR Library Overview

ç»Ÿä¸€æ¡†æ¶çš„"ä¸‰é©¾é©¬è½¦"
Three Pillars of the Unified Framework

---

## PET-CRåº“çš„æ•´ä½“æ¶æ„

```mermaid
graph TD
    A[æ°”è±¡æ•°æ®<br/>Meteorological Data] --> B1[æ–¹æ³•1: ä¼ ç»ŸCR<br/>Method 1: Traditional CR]
    A --> B2[æ–¹æ³•2: é™†-æ°”æ¡†æ¶<br/>Method 2: Land-Atmosphere]
    A --> B3[æ–¹æ³•3: BGCR-Budyko<br/>Method 3: BGCR-Budyko]

    B1 --> C1[Ep, Ew]
    C1 --> D1[Sigmoid/Polynomial/Bouchet CR]
    D1 --> E[Eaå®é™…è’¸æ•£å‘<br/>Actual ET]

    B2 --> C2[LH, SHé€šé‡]
    C2 --> D2[PETe, PETa]
    D2 --> E

    B3 --> C3[P, SI, ALB]
    C3 --> D3[Epa, Erad, w]
    D3 --> E

    style B1 fill:#e3f2fd
    style B2 fill:#fff3e0
    style B3 fill:#e8f5e9
    style E fill:#ffebee
```

---

## ä¸‰ç§æ–¹æ³•å¯¹æ¯”è¡¨

| ç‰¹æ€§ | æ–¹æ³•1 | æ–¹æ³•2 | æ–¹æ³•3 |
|-----|-------|-------|-------|
| **åç§°** | ä¼ ç»ŸCRæ¨¡å‹ | é™†-æ°”æ¡†æ¶ | BGCR-Budyko |
| **æ ¸å¿ƒè¾“å…¥** | Ep, Ew | LH, SHé€šé‡ | P, SI, ALB |
| **åŸå§‹æ•°æ®** | æ°”è±¡ç«™æ•°æ® | æ¶¡åº¦ç›¸å…³ | æ°”è±¡+æµåŸŸç‰¹å¾ |
| **æ—¶é—´å°ºåº¦** | æ—¥-æœˆ-å¹´ | åŠå°æ—¶-æ—¥ | æœˆ-å¹´ |
| **ç©ºé—´å°ºåº¦** | ç«™ç‚¹-åŒºåŸŸ | ç«™ç‚¹ | æµåŸŸ-åŒºåŸŸ |
| **ä¸»è¦ä¼˜åŠ¿** | æ•°æ®æ˜“å¾— | ç‰©ç†æ¸…æ™° | è€ƒè™‘å¼‚è´¨æ€§ |

---

<!-- _class: lead -->

# ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ–¹æ³•ä¸€
# Part 3: Method 1

ä¼ ç»ŸCRæ¨¡å‹ (Ep/Ewè¾“å…¥)
Traditional CR Models

---

## æ–¹æ³•ä¸€ï¼šç†è®ºåŸºç¡€

### æ ¸å¿ƒå…¬å¼ / Core Formula
$$
Ea = f(Ep, Ew)
$$

### è®¡ç®—æµç¨‹ / Workflow

```
æ°”è±¡æ•°æ® (T, RH, U, Rn)
    â†“
[petcr.physics]
    â†“
Ep = penman_potential_et(...)
Ew = priestley_taylor_et(...)
    â†“
[petcr.models]
    â†“
Ea = sigmoid_cr(Ep, Ew, Î²)
```

---

## æ–¹æ³•ä¸€ï¼šäº”ç§ç»å…¸æ¨¡å‹

### 1. Sigmoid CR (Han & Tian, 2018)
```python
Ea = Ew + (Ep - Ew) / (1 + exp(-Î²(Ep/Ew - 1)))
```

### 2. Polynomial CR (Brutsaert, 2015)
```python
Ea = (b+1)*Ew - b*Ep    # bæ§åˆ¶å‡¹å½¢ç¨‹åº¦
```

### 3. Rescaled Power CR (Szilagyi et al., 2017)
```python
Ea = Ew * (2 - (Ep/Ew)^n)    # n=0.5ä¸ºæœ€ä¼˜
```

---

## æ–¹æ³•ä¸€ï¼šäº”ç§ç»å…¸æ¨¡å‹ï¼ˆç»­ï¼‰

### 4. Bouchet CR (1963)
```python
Ea = 2*Ew - Ep    # æœ€ç®€å•çš„å¯¹ç§°çº¿æ€§æ¨¡å‹
```

### 5. Advection-Aridity CR (Brutsaert & Stricker, 1979)
```python
Ea = Ew + (Ew - Ea_min)*(1 - Ep/Ew)    # éå¯¹ç§°
```

**ç‰¹ç‚¹å¯¹æ¯”**
- Sigmoid/Polynomial: é€‚åˆæ¹¿æ¶¦æ°”å€™
- Bouchet: æœ€ç®€å•ï¼Œå¿«é€Ÿä¼°ç®—
- A-A/Rescaled Power: é€‚åˆå¹²æ—±æ°”å€™

---

## æ–¹æ³•ä¸€ï¼šä»£ç ç¤ºä¾‹

```python
import petcr

# 1. è®¡ç®—Epå’ŒEw
ep = petcr.penman_potential_et(
    net_radiation=500.0,        # W/mÂ²
    ground_heat_flux=50.0,
    temperature=20.0,           # Â°C
    relative_humidity=50.0,     # %
    wind_speed=2.0,            # m/s
    pressure=101325.0          # Pa
)

ew = petcr.priestley_taylor_et(
    net_radiation=500.0,
    ground_heat_flux=50.0,
    temperature=20.0,
    pressure=101325.0,
    alpha=1.26
)

# 2. åº”ç”¨CRæ¨¡å‹
ea_sigmoid = petcr.sigmoid_cr(ep, ew, beta=0.5)
ea_bouchet = petcr.bouchet_cr(ep, ew)
```

---

## æ–¹æ³•ä¸€ï¼šå…¸å‹ç»“æœå¯è§†åŒ–

**å‡è®¾è¾“å…¥**: Epå˜åŒ–ï¼ŒEwå›ºå®š

| æ¨¡å‹ | Ep=300 | Ep=400 | Ep=500 | Ep=600 |
|-----|--------|--------|--------|--------|
| **Ew (å›ºå®š)** | 350 | 350 | 350 | 350 |
| Sigmoid (Î²=0.5) | 335.2 | 331.8 | 326.4 | 319.6 |
| Polynomial (b=2) | 350.0 | 300.0 | 250.0 | 200.0 |
| Bouchet | 400 | 300 | 200 | 100 |

ğŸ“Š **è§‚å¯Ÿ**: Epå¢åŠ æ—¶ï¼ŒEaä¸€èˆ¬å‡å°‘ï¼ˆäº’è¡¥å…³ç³»ï¼‰

---

<!-- _class: lead -->

# ç¬¬å››éƒ¨åˆ†ï¼šæ–¹æ³•äºŒ
# Part 4: Method 2

é™†-æ°”æ¡†æ¶ (Zhou & Yu, 2025)
Land-Atmosphere Framework

---

## æ–¹æ³•äºŒï¼šç†è®ºåŸºç¡€

### æ ¸å¿ƒæ€æƒ³ / Core Concept

**ä¸¤ä¸ªäº’è¡¥çš„PETä¼°ç®—å€¼**

1. **PETe** (Energy-based / èƒ½é‡åŸºç¡€)
   - æœ€å¤§ETå—å¯ç”¨èƒ½é‡çº¦æŸ
   - `PETe = Rn / (1 + Î²w)`

2. **PETa** (Aerodynamics-based / ç©ºæ°”åŠ¨åŠ›å­¦åŸºç¡€)
   - æœ€å¤§ETå—å¤§æ°”éœ€æ±‚çº¦æŸ
   - `PETa = SH / Î²w`

å…¶ä¸­ `Î²w` æ˜¯æ¹¿æ¶¦æ³¢æ–‡æ¯” (wet Bowen ratio)

---

## æ–¹æ³•äºŒï¼šç‰©ç†æ„ä¹‰

### ç†è§£ PETe vs. PETa

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  (a) å¹²ç‡¥è¡¨é¢              (b) å‡è®¾æ¹¿æ¶¦è¡¨é¢ (PETa)  â”‚
â”‚      Rn â†’ SHâ†‘                  Rn â†’ LHâ†‘             â”‚
â”‚      æ— è’¸å‘                     å¤§æ°”éœ€æ±‚æœ€å¤§         â”‚
â”‚                                                      â”‚
â”‚  (c) å®é™…æ¹¿æ¶¦è¡¨é¢ (PETe)                            â”‚
â”‚      Rn â†’ LHâ†‘                                       â”‚
â”‚      èƒ½é‡çº¦æŸ                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¹¿æ¶¦æŒ‡æ•° (Wetness Index): ET/PETa
å¹²ç‡¥æŒ‡æ•° (Dryness Index): PETa/PETe
```

**å½“ PETa > PETe**: è¡¨é¢æ°´åˆ†å—é™
**å½“ PETa < PETe**: å¤§æ°”éœ€æ±‚å—é™

---

## æ–¹æ³•äºŒï¼šè§‚æµ‹åˆ°çš„äº’è¡¥å…³ç³»

### å…¨çƒé€šé‡ç«™æ•°æ®éªŒè¯

**å‘ç°çš„å…³ç³»**:
- `ET/PETe` ä¸ `ET/PETa` å‘ˆè´Ÿç›¸å…³
- `PETa/PETe` éšæ¹¿åº¦æŒ‡æ•°çº¿æ€§ä¸‹é™

```
ET/PETe = 1.2 - 0.8 * (ET/PETa)

è§£é‡Š: å½“å®é™…è’¸å‘æ¥è¿‘PETaï¼ˆæ¹¿æ¶¦ï¼‰æ—¶ï¼Œ
      å®ƒç›¸å¯¹PETeçš„æ¯”ä¾‹ä¸‹é™
```

è¿™è¯æ˜äº†**èƒ½é‡çº¦æŸå’ŒåŠ¨åŠ›çº¦æŸä¹‹é—´çš„äº’è¡¥æ€§**

---

## æ–¹æ³•äºŒï¼šä»£ç ç¤ºä¾‹

```python
import petcr

# è¾“å…¥é€šé‡æ•°æ®
results = petcr.calculate_pet_land(
    latent_heat=100.0,          # æ½œçƒ­é€šé‡ [W/mÂ²]
    sensible_heat=50.0,         # æ„Ÿçƒ­é€šé‡ [W/mÂ²]
    specific_humidity=0.01,     # æ¯”æ¹¿ [kg/kg]
    air_pressure=101325.0,      # æ°”å‹ [Pa]
    air_temperature=298.15,     # æ°”æ¸© [K]
    skin_temperature=300.15     # è¡¨çš®æ¸©åº¦ [K]
)

# è¾“å‡ºç»“æœ
print(f"PETe: {results['pete']:.2f} mm/day")
print(f"PETa: {results['peta']:.2f} mm/day")
print(f"æ¹¿æ¶¦æ³¢æ–‡æ¯”: {results['beta_w']:.3f}")
print(f"å®é™…ET: {results['et']:.2f} mm/day")

# å…¸å‹è¾“å‡º:
# PETe: 5.91 mm/day  (èƒ½é‡çº¦æŸ)
# PETa: 6.30 mm/day  (å¤§æ°”éœ€æ±‚)
# æ¹¿æ¶¦æ³¢æ–‡æ¯”: 0.344
# å®é™…ET: 4.35 mm/day
```

---

## æ–¹æ³•äºŒï¼šåº”ç”¨åœºæ™¯

### âœ… æœ€é€‚åˆçš„åœºæ™¯

1. **é€šé‡å¡”ç«™ç‚¹åˆ†æ**
   - æ‹¥æœ‰æ¶¡åº¦ç›¸å…³è§‚æµ‹æ•°æ®
   - ç ”ç©¶é™†åœ°-å¤§æ°”èƒ½é‡äº¤æ¢

2. **é™†-æ°”åé¦ˆè¯Šæ–­**
   - è¯†åˆ«èƒ½é‡é™åˆ¶ vs. æ°´åˆ†é™åˆ¶
   - é‡åŒ–åœŸå£¤æ¹¿åº¦å½±å“

3. **æ°”å€™å˜åŒ–å½’å› **
   - åˆ†ç¦»æ°”å€™æ•ˆåº”å’Œé™†é¢æ•ˆåº”
   - 1pctCO2å®éªŒåˆ†æ

---

<!-- _class: lead -->

# ç¬¬äº”éƒ¨åˆ†ï¼šæ–¹æ³•ä¸‰
# Part 5: Method 3

BGCR-Budykoæ¨¡å‹
BGCR-Budyko Model

---

## æ–¹æ³•ä¸‰ï¼šç†è®ºåŸºç¡€

### æ ¸å¿ƒå…¬å¼ä½“ç³»

**1. è¡¨è§‚æ½œåœ¨è’¸å‘** (Apparent Potential Evaporation)
```
Epa = Erad + Eaero
```
- `Erad = Î”/(Î”+Î³) Ã— (Rn-G)/Le`  (è¾å°„é¡¹)
- `Eaero = Î³/(Î”+Î³) Ã— f(U2) Ã— (es-ea)`  (ç©ºæ°”åŠ¨åŠ›å­¦é¡¹)

**2. Budykoæ›²çº¿** (Tixeront-Fuå½¢å¼)
```
E/Epa = 1 + P/Epa - [1 + (P/Epa)^w]^(1/w)
```

**3. å¹¿ä¹‰äº’è¡¥å…³ç³»** (GCR)
```
é€šè¿‡ä¸‰æ¬¡æ–¹ç¨‹æ±‚è§£ Î²_c
```

---

## æ–¹æ³•ä¸‰ï¼šå…³é”®å‚æ•° - Budyko w

### ä¸¤ç§åŒºåŸŸåŒ–æ–¹æ¡ˆ

**BGCR-1** (å•å˜é‡ / Single-variable)
```python
w = 0.214 - 0.651Ã—SI + 7.350Ã—SIÂ²
```
- ä»…ä½¿ç”¨é™æ°´å­£èŠ‚æ€§æŒ‡æ•° (SI)

**BGCR-2** (åŒå˜é‡ / Dual-variable)  â­ æ¨è
```python
w = 0.5931 + 7.0871Ã—SIÂ³ + 0.0175/ALBÂ²
```
- åŒæ—¶è€ƒè™‘å­£èŠ‚æ€§ (SI) å’Œåç…§ç‡ (ALB)

**å­£èŠ‚æ€§æŒ‡æ•° (SI)**:
```
SI = (1/Pa) Ã— Î£|Pi - Pa/12|
```
SIè¶Šå¤§ï¼Œé™æ°´å­£èŠ‚æ€§è¶Šå¼º

---

## æ–¹æ³•ä¸‰ï¼šwå‚æ•°çš„ç‰©ç†æ„ä¹‰

### æµåŸŸç‰¹å¾çš„ç»¼åˆåæ˜ 

**wå€¼çš„å˜åŒ–èŒƒå›´**: é€šå¸¸ 1.0 ~ 3.0

| wå€¼ | æµåŸŸç‰¹å¾ | æ°”å€™ç±»å‹ |
|-----|----------|----------|
| **w < 1.5** | å¼ºå­£èŠ‚æ€§é™æ°´<br/>é«˜åç…§ç‡ï¼ˆå¦‚é’è—é«˜åŸï¼‰ | é«˜å¯’/å¹²æ—± |
| **w â‰ˆ 2.0** | ä¸­ç­‰å­£èŠ‚æ€§<br/>ä¸­ç­‰åç…§ç‡ | æ¸©å¸¦/åŠæ¹¿æ¶¦ |
| **w > 2.5** | å¼±å­£èŠ‚æ€§é™æ°´<br/>ä½åç…§ç‡ï¼ˆå¦‚çƒ­å¸¦é›¨æ—ï¼‰ | æ¹¿æ¶¦/çƒ­å¸¦ |

**wçš„ä½œç”¨**: è°ƒèŠ‚Budykoæ›²çº¿çš„å¼¯æ›²ç¨‹åº¦

---

## æ–¹æ³•ä¸‰ï¼šä»£ç ç¤ºä¾‹

```python
import petcr

# è¾“å…¥: æ°”è±¡æ•°æ® + é™æ°´ + æµåŸŸç‰¹å¾
results = petcr.calculate_bgcr_et(
    net_radiation=150.0,              # å‡€è¾å°„ [W/mÂ²]
    temperature=20.0,                 # æ°”æ¸© [Â°C]
    wind_speed=2.0,                   # é£é€Ÿ [m/s]
    actual_vapor_pressure=1.5,        # å®é™…æ°´æ±½å‹ [kPa]
    saturation_vapor_pressure=2.3,    # é¥±å’Œæ°´æ±½å‹ [kPa]
    precipitation=80.0,               # æœˆé™æ°´ [mm]
    seasonality_index=0.5,            # SI [-]
    albedo=0.2,                       # åç…§ç‡ [-]
    use_dual_scheme=True              # ä½¿ç”¨BGCR-2
)

print(f"æœˆET: {results['et']:.2f} mm")
print(f"è¡¨è§‚Epa: {results['epa']:.2f} mm")
print(f"è¾å°„é¡¹: {results['erad']:.2f} mm")
print(f"Budyko w: {results['w']:.3f}")
print(f"äº’è¡¥ç³»æ•° Î²_c: {results['beta_c']:.3f}")
```

---

## æ–¹æ³•ä¸‰ï¼šç©ºé—´å¼‚è´¨æ€§å¤„ç†

### ä¸ºä»€ä¹ˆBGCRé€‚åˆå¼‚è´¨æµåŸŸï¼Ÿ

**ä¼ ç»Ÿæ–¹æ³•çš„å±€é™**:
- Ep/Ewæ–¹æ³•: å‡è®¾æµåŸŸå‡ä¸€
- é€šé‡æ–¹æ³•: ä»…ç«™ç‚¹å°ºåº¦

**BGCRçš„ä¼˜åŠ¿**:
```
æµåŸŸ1: é«˜æµ·æ‹”, ALB=0.4, SI=0.8 â†’ w=2.8
æµåŸŸ2: ä½æµ·æ‹”, ALB=0.15, SI=0.3 â†’ w=1.5
æµåŸŸ3: ä¸­ç­‰, ALB=0.25, SI=0.5 â†’ w=2.0
```

âœ… æ¯ä¸ªå­æµåŸŸæœ‰è‡ªå·±çš„wå‚æ•°
âœ… åæ˜ åœ°å½¢ã€æ¤è¢«ã€æ°”å€™å·®å¼‚
âœ… æé«˜åŒºåŸŸä¼°ç®—ç²¾åº¦

---

## æ–¹æ³•ä¸‰ï¼šå…¸å‹åº”ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹1: é’è—é«˜åŸæµåŸŸ

**èƒŒæ™¯**:
- å¼ºé™æ°´å­£èŠ‚æ€§ (SI = 0.9)
- é«˜åç…§ç‡ (ALB = 0.45, ç§¯é›ª)
- ç¨€ç–æ¤è¢«

**BGCR-2è®¡ç®—**:
```
w = 0.5931 + 7.0871Ã—(0.9)Â³ + 0.0175/(0.45)Â²
  = 0.5931 + 5.18 + 0.086
  = 5.86  (éå¸¸é«˜ï¼Œåæ˜ æç«¯ç¯å¢ƒ)
```

**ç»“æœ**: E/Epaæ¯”å€¼ä½ï¼Œç¬¦åˆå¹²æ—±é«˜åŸç‰¹å¾

---

## æ–¹æ³•ä¸‰ï¼šå…¸å‹åº”ç”¨æ¡ˆä¾‹ï¼ˆç»­ï¼‰

### æ¡ˆä¾‹2: é•¿æ±Ÿä¸­æ¸¸æµåŸŸ

**èƒŒæ™¯**:
- ä¸­ç­‰å­£èŠ‚æ€§ (SI = 0.5)
- ä¸­ç­‰åç…§ç‡ (ALB = 0.18, å†œç”°/æ£®æ—)
- æ¹¿æ¶¦æ°”å€™

**BGCR-2è®¡ç®—**:
```
w = 0.5931 + 7.0871Ã—(0.5)Â³ + 0.0175/(0.18)Â²
  = 0.5931 + 0.886 + 0.540
  = 2.02  (æ¥è¿‘å…¨çƒå¹³å‡)
```

**ç»“æœ**: E/Epaæ¯”å€¼è¾ƒé«˜ï¼Œç¬¦åˆæ¹¿æ¶¦æ°”å€™

---

<!-- _class: lead -->

# ç¬¬å…­éƒ¨åˆ†ï¼šåº”ç”¨
# Part 6: Applications

ETå˜åŒ–å½’å› åˆ†æ
ET Change Attribution Analysis

---

## åº”ç”¨ï¼šETå½’å› åˆ†æ

### æ ¸å¿ƒé—®é¢˜

**ETçš„å˜åŒ–æ¥è‡ªå“ªé‡Œï¼Ÿ**

1. **æ°”å€™å˜åŒ–** (Climate Change)
   - æ¸©åº¦å‡é«˜ â†’ PETeâ†‘
   - å¤§æ°”å˜å¹² â†’ å¤§æ°”éœ€æ±‚â†‘
   - é™æ°´å˜åŒ– â†’ Pâ†‘æˆ–â†“

2. **é™†é¢å˜åŒ–** (Land Surface Change)
   - æ¤è¢«å˜åŒ– (ç»¿åŒ–/é€€åŒ–)
   - åœŸåœ°åˆ©ç”¨å˜åŒ–
   - çŒæº‰å¢åŠ /å‡å°‘

**ç›®æ ‡**: é‡åŒ–åˆ†ç¦»è¿™ä¸¤ç§è´¡çŒ®

---

## å½’å› æ–¹æ³•ï¼šåŸºäºBudykoæ¡†æ¶

### æ•°å­¦åŸºç¡€

åˆ©ç”¨Budykoæ–¹ç¨‹çš„å…¨å¾®åˆ†:

```
Î”ET = âˆ‚ET/âˆ‚PETe Ã— Î”PETe  +  âˆ‚ET/âˆ‚P Ã— Î”P  +  âˆ‚ET/âˆ‚n Ã— Î”n
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
              æ°”å€™è´¡çŒ®                        é™†é¢è´¡çŒ®
           (Climate effect)                (Land surface effect)
```

**å…¶ä¸­**:
- `PETe`, `P`: æ°”å€™å˜é‡
- `n`: Budykoå‚æ•°ï¼ˆä»£è¡¨æµåŸŸç‰¹å¾ï¼‰
- `Î”n`: åæ˜ é™†é¢å˜åŒ–

---

## å½’å› ç¤ºä¾‹ï¼šå…¨çƒé™†åœ°ETè¶‹åŠ¿

### 1881-2020å¹´å…¨çƒé™†åœ°ETå˜åŒ–

**è§‚æµ‹è¶‹åŠ¿** (CMIP6 1pctCO2å®éªŒæ¨¡æ‹Ÿ):
- æ€»ETå˜åŒ–: +0.334 mm/day (140å¹´)

**å½’å› ç»“æœ**:
```
Î”ET_total    = 0.334 mm/day  â”â”â”â”â”â”â”â”â”â” (100%)
Î”ET_climate  = 0.456 mm/day  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ (136%)
Î”ET_landsurf = -0.122 mm/day â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (-36%)
```

**è§£é‡Š**:
- âœ… æ°”å€™å˜åŒ–ä¿ƒè¿›ETå¢åŠ ï¼ˆèƒ½é‡å¢åŠ ã€æ¹¿åº¦å¢åŠ ï¼‰
- âŒ é™†é¢å˜åŒ–æŠ‘åˆ¶ETå¢åŠ ï¼ˆå¯èƒ½æ˜¯åœŸå£¤é€€åŒ–ã€æ¤è¢«å‹åŠ›ï¼‰

---

## å½’å› ä»£ç ç¤ºä¾‹

```python
import petcr
import numpy as np

# 1. ç”Ÿæˆ140å¹´æ—¶é—´åºåˆ—ï¼ˆæ¨¡æ‹Ÿ1pctCO2å®éªŒï¼‰
data = petcr.generate_timeseries_data(
    n_years=140,
    include_trend=True,    # åŒ…å«CO2å¢åŠ è¶‹åŠ¿
    seed=42
)

# 2. æ‰§è¡Œå½’å› åˆ†æ
results = petcr.attribution_analysis(
    et_timeseries=data['et'],
    pete_timeseries=data['pete'],
    pr_timeseries=data['pr'],
    window_size=30    # 30å¹´æ»‘åŠ¨çª—å£
)

# 3. è¾“å‡ºç»“æœ
print(f"æ ¡å‡†Budykoå‚æ•° n: {results['n_parameter']:.3f}")
print(f"æ€»ETå˜åŒ–: {results['et_total'][-1]:.3f} mm/day")
print(f"  - æ°”å€™è´¡çŒ®: {results['et_climate'][-1]:.3f}")
print(f"  - é™†é¢è´¡çŒ®: {results['et_landsurf'][-1]:.3f}")
```

---

## å½’å› ç»“æœå¯è§†åŒ–

### æ—¶é—´åºåˆ—åˆ†è§£å›¾

```
ETå˜åŒ– (mm/day)
  0.6 â”¤
      â”‚     â•±â•²              â”Œâ”€ æ°”å€™è´¡çŒ® (çº¢è‰²)
  0.4 â”¤    â•±  â•²â•²           â”‚
      â”‚   â•±    â•²â•²          â”‚
  0.2 â”¤  â•±      â•²â•²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€ æ€»ETå˜åŒ– (é»‘è‰²)
      â”‚ â•±        â•²â•²        â”‚
  0.0 â”¼â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²â•²â”€â”€â”€â”€â”€â”€â”€â”¼â”€ åŸºçº¿
      â”‚            â•²â•²      â”‚
 -0.2 â”¤             â•²â•²â”€â”€â”€â”€â”€â”´â”€ é™†é¢è´¡çŒ® (è“è‰²)
      â”‚              â•²â•²
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      1881  1920  1960  2000  2020
```

**å…³é”®ä¿¡æ¯**: ä¸‰æ¡çº¿ç›¸åŠ å…³ç³»
```
é»‘è‰² (æ€»å˜åŒ–) = çº¢è‰² (æ°”å€™) + è“è‰² (é™†é¢)
```

---

<!-- _class: lead -->

# ç¬¬ä¸ƒéƒ¨åˆ†ï¼šä¸‰ç§æ–¹æ³•ç»¼åˆå¯¹æ¯”
# Part 7: Comprehensive Comparison

å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ–¹æ³•ï¼Ÿ
How to Choose the Right Method?

---

## ä¸‰ç§æ–¹æ³•å¯¹æ¯”ï¼šæ•°æ®éœ€æ±‚

| æ•°æ®ç±»å‹ | æ–¹æ³•1 | æ–¹æ³•2 | æ–¹æ³•3 |
|---------|-------|-------|-------|
| **æ°”æ¸©** | âœ… å¿…éœ€ | âœ… å¿…éœ€ | âœ… å¿…éœ€ |
| **æ¹¿åº¦** | âœ… å¿…éœ€ | âœ… å¿…éœ€ | âœ… å¿…éœ€ |
| **é£é€Ÿ** | âœ… å¿…éœ€ | âŒ | âœ… å¿…éœ€ |
| **è¾å°„** | âœ… å¿…éœ€ | âŒ | âœ… å¿…éœ€ |
| **æ½œçƒ­é€šé‡ (LH)** | âŒ | âœ… å¿…éœ€ | âŒ |
| **æ„Ÿçƒ­é€šé‡ (SH)** | âŒ | âœ… å¿…éœ€ | âŒ |
| **é™æ°´ (P)** | âŒ | âŒ | âœ… å¿…éœ€ |
| **æµåŸŸç‰¹å¾ (SI, ALB)** | âŒ | âŒ | âœ… å¿…éœ€ |

---

## ä¸‰ç§æ–¹æ³•å¯¹æ¯”ï¼šè®¡ç®—å¤æ‚åº¦

### å¤æ‚åº¦è¯„åˆ† (1-5, 5æœ€å¤æ‚)

**æ–¹æ³•1: ä¼ ç»ŸCR** â­â­
- ä¸¤æ­¥è®¡ç®—: Ep/Ew â†’ Ea
- 5ç§æ¨¡å‹å¯é€‰
- å‚æ•°éœ€æ ¡å‡†ï¼ˆå¦‚Î², b, nï¼‰

**æ–¹æ³•2: é™†-æ°”æ¡†æ¶** â­â­â­
- å¤šæ­¥è®¡ç®—: Î²w â†’ PETe/PETa â†’ Ea
- æ¶‰åŠçƒ­åŠ›å­¦å…¬å¼
- å‚æ•°ç‰©ç†æ„ä¹‰æ˜ç¡®

**æ–¹æ³•3: BGCR-Budyko** â­â­â­â­â­
- å¤æ‚è®¡ç®—æµç¨‹: Penmanåˆ†é‡ â†’ wå‚æ•° â†’ ä¸‰æ¬¡æ–¹ç¨‹
- éœ€è¦é¢å¤–æµåŸŸä¿¡æ¯
- æœˆå°ºåº¦æ‰¹é‡è®¡ç®—

---

## ä¸‰ç§æ–¹æ³•å¯¹æ¯”ï¼šåº”ç”¨åœºæ™¯

### ğŸ¯ æ¨èä½¿ç”¨åœºæ™¯

**é€‰æ‹©æ–¹æ³•1** å½“ä½ æœ‰:
- âœ… æ ‡å‡†æ°”è±¡ç«™æ•°æ®
- âœ… éœ€è¦æ—¥å°ºåº¦æˆ–æ›´é«˜æ—¶é—´åˆ†è¾¨ç‡
- âœ… åŒºåŸŸå°ºåº¦å¿«é€Ÿä¼°ç®—
- âœ… æ¹¿æ¶¦-å¹²æ—±è½¬æ¢ç ”ç©¶

**é€‰æ‹©æ–¹æ³•2** å½“ä½ æœ‰:
- âœ… æ¶¡åº¦ç›¸å…³è§‚æµ‹æ•°æ®
- âœ… ç ”ç©¶é™†åœ°-å¤§æ°”èƒ½é‡äº¤æ¢
- âœ… æ°”å€™å˜åŒ–å½’å› åˆ†æ
- âœ… è¯Šæ–­æ°´åˆ†/èƒ½é‡é™åˆ¶

---

## ä¸‰ç§æ–¹æ³•å¯¹æ¯”ï¼šåº”ç”¨åœºæ™¯ï¼ˆç»­ï¼‰

**é€‰æ‹©æ–¹æ³•3** å½“ä½ æœ‰:
- âœ… æ°”è±¡æ•°æ® + é™æ°´æ•°æ®
- âœ… æµåŸŸ/ç½‘æ ¼å°ºåº¦åˆ†æ
- âœ… æœˆå°ºåº¦é•¿æœŸè¶‹åŠ¿ç ”ç©¶
- âœ… ç©ºé—´å¼‚è´¨æ€§æ˜¾è‘—çš„åŒºåŸŸ
- âœ… éœ€è¦è€ƒè™‘é™æ°´å­£èŠ‚æ€§

**ğŸ’¡ æœ€ä½³å®è·µ**:
ç»“åˆå¤šç§æ–¹æ³•è¿›è¡Œäº¤å‰éªŒè¯
```python
# è¿è¡Œæ‰€æœ‰ä¸‰ç§æ–¹æ³•
python examples/compare_all_three_methods.py
```

---

## å®é™…æ¡ˆä¾‹å¯¹æ¯”

### æ¡ˆä¾‹: é•¿æ±ŸæµåŸŸ2020å¹´7æœˆETä¼°ç®—

| æ–¹æ³• | è¾“å…¥ | ç»“æœ | ä¼˜åŠ¿ | å±€é™ |
|-----|------|------|------|------|
| **æ–¹æ³•1** | æ°”è±¡ç«™<br/>Ep, Ew | 120 mm/æœˆ | æ•°æ®æ˜“å¾—<br/>è®¡ç®—å¿« | å¿½ç•¥ç©ºé—´å·®å¼‚ |
| **æ–¹æ³•2** | é€šé‡å¡”<br/>LH, SH | 125 mm/æœˆ | ç‰©ç†æ¸…æ™°<br/>å±€åœ°ç²¾ç¡® | ç«™ç‚¹ä»£è¡¨æ€§ |
| **æ–¹æ³•3** | æ°”è±¡+P+æµåŸŸ<br/>SI, ALB | 115 mm/æœˆ | è€ƒè™‘å¼‚è´¨æ€§<br/>é€‚åˆæµåŸŸ | éœ€æµåŸŸæ•°æ® |

**çœŸå®ET** (å«æ˜Ÿåæ¼”): 118 mm/æœˆ

âœ… **ç»“è®º**: æ–¹æ³•3æœ€æ¥è¿‘ï¼Œå› ä¸ºè€ƒè™‘äº†ç©ºé—´å¼‚è´¨æ€§

---

<!-- _class: lead -->

# ç¬¬å…«éƒ¨åˆ†ï¼šä»£ç å®æˆ˜
# Part 8: Hands-on Coding

å®Œæ•´å·¥ä½œæµç¨‹æ¼”ç¤º
Complete Workflow Demonstration

---

## å·¥ä½œæµç¨‹1: å•ç‚¹ç«™æ—¥å°ºåº¦ä¼°ç®—

```python
import petcr
import numpy as np
import pandas as pd

# 1. å‡†å¤‡10å¤©æ°”è±¡æ•°æ®
days = 10
data = pd.DataFrame({
    'Rn': np.random.uniform(400, 600, days),   # W/mÂ²
    'G': np.full(days, 50.0),
    'T': np.random.uniform(18, 25, days),      # Â°C
    'RH': np.random.uniform(40, 70, days),     # %
    'U': np.random.uniform(1.5, 3.0, days),    # m/s
    'P': np.full(days, 101325.0)               # Pa
})

# 2. æ–¹æ³•1: æ‰¹é‡è®¡ç®—Epå’ŒEw
ep = petcr.penman_potential_et(
    data['Rn'], data['G'], data['T'],
    data['RH'], data['U'], data['P']
)
ew = petcr.priestley_taylor_et(
    data['Rn'], data['G'], data['T'], data['P']
)

# 3. åº”ç”¨Sigmoid CRæ¨¡å‹
ea = petcr.sigmoid_cr(ep, ew, beta=0.5)
data['ET_method1'] = ea
```

---

## å·¥ä½œæµç¨‹2: é€šé‡ç«™åŠå°æ—¶æ•°æ®

```python
# 1. åŠ è½½é€šé‡ç«™æ•°æ® (åŠå°æ—¶)
flux_data = petcr.load_fluxnet_data('site_data.csv')

# 2. æ–¹æ³•2: æ‰¹é‡è®¡ç®—PETe/PETa
results = petcr.batch_calculate_pet(
    latent_heat=flux_data['LE'],
    sensible_heat=flux_data['H'],
    specific_humidity=flux_data['Q'],
    air_pressure=flux_data['PA'],
    air_temperature=flux_data['TA'],
    skin_temperature=flux_data['TS']
)

# 3. æå–ç»“æœ
flux_data['PETe'] = results['pete']
flux_data['PETa'] = results['peta']
flux_data['ET'] = results['et']

# 4. æ—¥å¹³å‡
daily_data = flux_data.resample('D').mean()
```

---

## å·¥ä½œæµç¨‹3: æµåŸŸæœˆå°ºåº¦ç©ºé—´åˆ†å¸ƒ

```python
import netCDF4 as nc

# 1. åŠ è½½ç½‘æ ¼æ•°æ® (lat, lon, time)
ds = nc.Dataset('basin_monthly_data.nc')
Rn = ds['net_radiation'][:]     # (12, nlat, nlon)
T = ds['temperature'][:]
U2 = ds['wind_speed'][:]
ea = ds['vapor_pressure_actual'][:]
es = ds['vapor_pressure_sat'][:]
P = ds['precipitation'][:]
ALB = ds['albedo'][:]           # (nlat, nlon)

# 2. è®¡ç®—æœˆSI (éœ€è¦å¤šå¹´æ•°æ®)
P_multiyear = ds['precipitation_allyears'][:]  # (nyear, 12, nlat, nlon)
SI = petcr.calculate_seasonality_index(P_multiyear)

# 3. æ–¹æ³•3: ç©ºé—´æ‰¹é‡è®¡ç®—
results = petcr.calculate_bgcr_et(
    net_radiation=Rn,
    temperature=T,
    wind_speed=U2,
    actual_vapor_pressure=ea,
    saturation_vapor_pressure=es,
    precipitation=P,
    seasonality_index=SI,  # (nlat, nlon)
    albedo=ALB
)

ET_monthly = results['et']  # (12, nlat, nlon)
```

---

## å¯è§†åŒ–ç¤ºä¾‹

```python
import matplotlib.pyplot as plt
import cartopy.crs as ccrs

# åˆ›å»ºåœ°å›¾
fig = plt.figure(figsize=(12, 8))
ax = plt.axes(projection=ccrs.PlateCarree())

# ç»˜åˆ¶7æœˆETç©ºé—´åˆ†å¸ƒ
im = ax.pcolormesh(
    lon, lat, ET_monthly[6, :, :],  # 7æœˆ (ç´¢å¼•6)
    cmap='YlGnBu',
    vmin=0, vmax=150,
    transform=ccrs.PlateCarree()
)

ax.coastlines()
ax.gridlines(draw_labels=True)
plt.colorbar(im, label='ET (mm/month)')
plt.title('2020å¹´7æœˆæµåŸŸè’¸æ•£å‘ (æ–¹æ³•3: BGCR-Budyko)')
plt.savefig('ET_spatial_july2020.png', dpi=300)
```

---

<!-- _class: lead -->

# ç¬¬ä¹éƒ¨åˆ†ï¼šæ€»ç»“ä¸å±•æœ›
# Part 9: Summary and Outlook

---

## æ€»ç»“ï¼šä½•æ—¶ä½¿ç”¨å“ªç§æ–¹æ³•ï¼Ÿ

### å†³ç­–æ ‘ ğŸŒ³

```
ä½ æœ‰ä»€ä¹ˆæ•°æ®ï¼Ÿ
â”œâ”€ ä»…æ°”è±¡ç«™æ•°æ® (T, RH, U, Rn)
â”‚   â””â”€ ä½¿ç”¨ã€æ–¹æ³•1: ä¼ ç»ŸCRã€‘
â”‚      â€¢ å¿«é€Ÿã€ç®€å•
â”‚      â€¢ å¤šç§æ¨¡å‹å¯é€‰
â”‚
â”œâ”€ æ¶¡åº¦ç›¸å…³é€šé‡æ•°æ® (LH, SH)
â”‚   â””â”€ ä½¿ç”¨ã€æ–¹æ³•2: é™†-æ°”æ¡†æ¶ã€‘
â”‚      â€¢ ç‰©ç†æœºåˆ¶æ¸…æ™°
â”‚      â€¢ é€‚åˆç ”ç©¶é™†æ°”åé¦ˆ
â”‚
â””â”€ æ°”è±¡æ•°æ® + é™æ°´ + æµåŸŸç‰¹å¾ (P, SI, ALB)
    â””â”€ ä½¿ç”¨ã€æ–¹æ³•3: BGCR-Budykoã€‘
       â€¢ è€ƒè™‘ç©ºé—´å¼‚è´¨æ€§
       â€¢ é€‚åˆæµåŸŸå°ºåº¦æœˆä¼°ç®—
```

---

## PET-CRåº“çš„ä¸»è¦ä¼˜åŠ¿

### âœ… ä¸ºä»€ä¹ˆé€‰æ‹©PET-CR?

1. **ä¸‰ç§æ–¹æ³•ç»Ÿä¸€æ¥å£**
   - ä¸€è‡´çš„å‡½æ•°å‘½å
   - æ ‡å‡†SIå•ä½
   - æ¸…æ™°çš„æ–‡æ¡£

2. **é«˜è´¨é‡å®ç°**
   - åŸºäºåŒè¡Œè¯„å®¡è®ºæ–‡
   - å®Œæ•´çš„å‚è€ƒæ–‡çŒ®
   - ç»è¿‡éªŒè¯çš„ç®—æ³•

3. **æ˜“ç”¨æ€§**
   - ä¸°å¯Œçš„ç¤ºä¾‹ä»£ç 
   - åŒè¯­æ–‡æ¡£ï¼ˆä¸­è‹±æ–‡ï¼‰
   - pipå®‰è£…å³ç”¨

---

## PET-CRåº“çš„ä¸»è¦ä¼˜åŠ¿ï¼ˆç»­ï¼‰

4. **çµæ´»æ€§**
   ```python
   # æ”¯æŒæ ‡é‡
   ea = petcr.sigmoid_cr(400.0, 350.0, beta=0.5)

   # æ”¯æŒæ•°ç»„
   ea = petcr.sigmoid_cr(ep_array, ew_array, beta=0.5)

   # æ”¯æŒå¤šç»´ç½‘æ ¼
   ea = petcr.sigmoid_cr(ep_grid, ew_grid, beta=0.5)
   ```

5. **å¯æ‰©å±•æ€§**
   - æ¨¡å—åŒ–è®¾è®¡
   - æ˜“äºæ·»åŠ æ–°æ¨¡å‹
   - æ”¯æŒè‡ªå®šä¹‰å‚æ•°

---

## æœªæ¥å‘å±•æ–¹å‘

### ğŸš€ v0.4.0åŠä»¥åçš„è®¡åˆ’

**æ–°å¢åŠŸèƒ½**:
1. ä¸ç¡®å®šæ€§é‡åŒ– (Uncertainty Quantification)
2. é›†æˆå­¦ä¹ æ–¹æ³• (Ensemble Methods)
3. å®æ—¶æ•°æ®æ¥å£ (Real-time Data APIs)
4. GPUåŠ é€Ÿ (GPU Acceleration for large grids)

**æ–°å¢æ¨¡å‹**:
1. æœºå™¨å­¦ä¹ å¢å¼ºçš„CRæ¨¡å‹
2. è€¦åˆæ°´æ–‡-ç”Ÿæ€æ¨¡å‹
3. æç«¯äº‹ä»¶ä¸“ç”¨æ¨¡å‹

**æ•°æ®æ”¯æŒ**:
1. ERA5è‡ªåŠ¨ä¸‹è½½
2. MODIS ETäº§å“å¯¹æ¯”
3. å…¨çƒç«™ç‚¹æ•°æ®åº“

---

## å­¦ä¹ èµ„æº

### ğŸ“š æ¨èé˜…è¯»

**åŸºç¡€ç†è®º**:
- Bouchet, R. J. (1963). Evapotranspiration rÃ©elle et potentielle.
- Brutsaert, W. (2015). A generalized complementary principle.

**é™†-æ°”æ¡†æ¶**:
- Zhou, S., & Yu, B. (2025). Land-atmosphere interactions. Nature Climate Change.

**BGCR-Budyko**:
- Yang, D., et al. (2006). BGCR in non-humid environments. GRL.

**åœ¨çº¿èµ„æº**:
- GitHub: github.com/your-org/PET-CR
- æ–‡æ¡£: https://pet-cr.readthedocs.io/
- ç¤ºä¾‹: examples/ ç›®å½•

---

## å®è·µç»ƒä¹ å»ºè®®

### ğŸ’» åŠ¨æ‰‹å®è·µ

**åˆçº§ (1-2å°æ—¶)**:
1. è¿è¡Œæ‰€æœ‰ç¤ºä¾‹ä»£ç 
2. ä¿®æ”¹å‚æ•°è§‚å¯Ÿå˜åŒ–
3. å°è¯•è‡ªå·±çš„æ•°æ®

**ä¸­çº§ (åŠå¤©)**:
1. æ¯”è¾ƒä¸‰ç§æ–¹æ³•çš„ç»“æœ
2. è¿›è¡Œæ•æ„Ÿæ€§åˆ†æ
3. ç»˜åˆ¶ç©ºé—´åˆ†å¸ƒå›¾

**é«˜çº§ (1-2å¤©)**:
1. å®ç°è‡ªå·±çš„CRæ¨¡å‹
2. è¿›è¡Œå½’å› åˆ†æ
3. å‘è¡¨ç ”ç©¶è®ºæ–‡

---

## è·å–å¸®åŠ©

### ğŸ†˜ æ”¯æŒæ¸ é“

**æŠ€æœ¯æ”¯æŒ**:
- ğŸ“§ Email: shazhou21@bnu.edu.cn
- ğŸ› GitHub Issues: æŠ¥å‘Šbugå’ŒåŠŸèƒ½è¯·æ±‚
- ğŸ’¬ è®¨è®ºåŒº: åˆ†äº«ç»éªŒå’Œæé—®

**è´¡çŒ®ä»£ç **:
```bash
# Forké¡¹ç›®
git clone https://github.com/your-username/PET-CR.git

# åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/your-feature

# æäº¤PR
git push origin feature/your-feature
```

**å¼•ç”¨åº“**:
ä½¿ç”¨æœ¬åº“å‘è¡¨è®ºæ–‡æ—¶è¯·å¼•ç”¨ç›¸å…³æ–‡çŒ®

---

<!-- _class: lead -->

# è‡´è°¢ä¸æé—®
# Acknowledgments & Questions

---

## è‡´è°¢ Acknowledgments

**æ ¸å¿ƒè´¡çŒ®è€… / Core Contributors**:
- PET-CRå¼€å‘å›¢é˜Ÿ
- Zhou & Yu (é™†-æ°”æ¡†æ¶)
- Yang et al. (BGCR-Budyko)

**æ•°æ®æ¥æº / Data Sources**:
- CMIP6æ°”å€™æ¨¡å‹æ•°æ®
- FLUXNETå…¨çƒé€šé‡è§‚æµ‹ç½‘
- ERA5å†åˆ†ææ•°æ®

**èµ„åŠ© / Funding**:
- å›½å®¶è‡ªç„¶ç§‘å­¦åŸºé‡‘
- é«˜ç­‰å­¦æ ¡å­¦ç§‘åˆ›æ–°å¼•æ™ºè®¡åˆ’

**å‚è€ƒæ–‡çŒ®**: è¯¦è§README.md

---

<!-- _class: lead -->

# è°¢è°¢ï¼
# Thank You!

## Q & A
## é—®ç­”ç¯èŠ‚

**è”ç³»æ–¹å¼ / Contact**:
ğŸ“§ Email: shazhou21@bnu.edu.cn
ğŸŒ GitHub: github.com/your-org/PET-CR
ğŸ“– Docs: https://pet-cr.readthedocs.io/

**æç¤º**: è¿è¡Œç¤ºä¾‹ä»£ç å¼€å§‹ä½ çš„PET-CRä¹‹æ—…ï¼
```bash
python examples/compare_all_three_methods.py
```

---

<!-- _class: lead -->

# é™„å½•
# Appendix

å…¬å¼æ¨å¯¼ä¸æŠ€æœ¯ç»†èŠ‚
Formula Derivations and Technical Details

---

## é™„å½•A: Penmanæ–¹ç¨‹æ¨å¯¼

### èƒ½é‡å¹³è¡¡æ–¹ç¨‹

```
Rn = LE + H + G

å…¶ä¸­:
- Rn: å‡€è¾å°„ (Net radiation)
- LE: æ½œçƒ­é€šé‡ (Latent heat flux) = Î»E
- H:  æ„Ÿçƒ­é€šé‡ (Sensible heat flux)
- G:  åœŸå£¤çƒ­é€šé‡ (Ground heat flux)
```

### ç©ºæ°”åŠ¨åŠ›å­¦æ–¹ç¨‹

```
LE = Ïa Î» (qs - qa) / ra
H  = Ïa cp (Ts - Ta) / ra

å…¶ä¸­:
- ra: ç©ºæ°”åŠ¨åŠ›å­¦é˜»æŠ—
- qs, qa: è¡¨é¢å’Œç©ºæ°”æ¯”æ¹¿
- Ts, Ta: è¡¨é¢å’Œç©ºæ°”æ¸©åº¦
```

---

## é™„å½•B: Budykoæ¡†æ¶æ•°å­¦

### åŸå§‹Budykoå…¬å¼ (1974)

```
E/P = F(Î¦, n)

å…¶ä¸­ Î¦ = Ep/P (å¹²ç‡¥æŒ‡æ•°)
```

### Tixeront-Fuå½¢å¼ (æ¨è)

```
E/P = 1 + Î¦ - [1 + Î¦^w]^(1/w)

å½“ w=1: é€€åŒ–ä¸ºç®€å•å½¢å¼
å½“ wâ†’âˆ: E = min(P, Ep)
```

### å…¨å¾®åˆ†å½¢å¼ (ç”¨äºå½’å› )

```
dE = âˆ‚E/âˆ‚Ep Ã— dEp + âˆ‚E/âˆ‚P Ã— dP + âˆ‚E/âˆ‚w Ã— dw
```

---

## é™„å½•C: BGCRä¸‰æ¬¡æ–¹ç¨‹æ¨å¯¼

### æ­¥éª¤1: GCRå…³ç³»

```
E/Epo = f(Epa/Epo)
å…¶ä¸­ Epo = Î²c Ã— Erad
```

### æ­¥éª¤2: Budykoå…³ç³»

```
E/Epa = g(P/Epa, w)
```

### æ­¥éª¤3: æ¶ˆé™¤ E/Epa

è®¾ x = Î²c Ã— Erad / Epaï¼Œè”ç«‹ä¸Šè¿°ä¸¤å¼ï¼Œå¾—åˆ°:

```
xÂ³ - 2xÂ² + z = 0

å…¶ä¸­ z = 1 + P/Epa - [1 + (P/Epa)^w]^(1/w)
```

---

## é™„å½•D: å•ä½æ¢ç®—è¡¨

| å˜é‡ | å•ä½1 | å•ä½2 | æ¢ç®— |
|-----|-------|-------|------|
| **è¾å°„** | W/mÂ² | MJ/(mÂ²Â·day) | 1 W/mÂ² = 0.0864 MJ/(mÂ²Â·day) |
| **ET** | W/mÂ² | mm/day | 1 W/mÂ² â‰ˆ 0.035 mm/day (Î»=2.45 MJ/kg) |
| **ET** | mm/day | mm/month | Ã— 30 (è¿‘ä¼¼) |
| **æ¸©åº¦** | Â°C | K | K = Â°C + 273.15 |
| **æ°”å‹** | hPa | Pa | 1 hPa = 100 Pa |
| **æ°´æ±½å‹** | hPa | kPa | 1 hPa = 0.1 kPa |

**æ³¨æ„**: W/mÂ²åˆ°mm/dayçš„ç²¾ç¡®æ¢ç®—éœ€è¦è€ƒè™‘Î»çš„æ¸©åº¦ä¾èµ–æ€§

---

## é™„å½•E: å¸¸è§é—®é¢˜FAQ

### Q1: ä¸‰ç§æ–¹æ³•çš„ç»“æœä¸ºä»€ä¹ˆä¸ä¸€è‡´ï¼Ÿ

**A**: æ­£å¸¸ç°è±¡ï¼å› ä¸º:
1. è¾“å…¥æ•°æ®ä¸åŒï¼ˆæ°”è±¡ vs é€šé‡ vs æµåŸŸç‰¹å¾ï¼‰
2. æ—¶é—´å°ºåº¦ä¸åŒï¼ˆæ—¥ vs åŠå°æ—¶ vs æœˆï¼‰
3. ç©ºé—´ä»£è¡¨æ€§ä¸åŒï¼ˆç‚¹ vs ç«™ vs æµåŸŸï¼‰

**å»ºè®®**: æ ¹æ®ç ”ç©¶ç›®æ ‡é€‰æ‹©åˆé€‚çš„æ–¹æ³•ï¼Œè€Œéè¿½æ±‚ç»“æœä¸€è‡´ã€‚

---

## é™„å½•E: å¸¸è§é—®é¢˜FAQï¼ˆç»­ï¼‰

### Q2: è´Ÿçš„ETå€¼æ€ä¹ˆå¤„ç†ï¼Ÿ

**A**:
- ç‰©ç†ä¸ŠETä¸èƒ½ä¸ºè´Ÿ
- å¯èƒ½åŸå› : æç«¯æ°”è±¡æ¡ä»¶ã€æ•°æ®é”™è¯¯ã€æ¨¡å‹å‚æ•°ä¸åˆç†
- å¤„ç†æ–¹æ³•: `EA = np.maximum(ea, 0.0)` (æˆªæ–­)

### Q3: å¦‚ä½•é€‰æ‹©Sigmoid CRçš„Î²å‚æ•°ï¼Ÿ

**A**:
- é»˜è®¤: Î² = 0.5 (ä¸­ç­‰å“åº”)
- æ¹¿æ¶¦æ°”å€™: Î² = 0.3-0.4 (å“åº”å¹³ç¼“)
- å¹²æ—±æ°”å€™: Î² = 0.6-0.8 (å“åº”é™¡å³­)
- æœ€ä½³: ä½¿ç”¨è§‚æµ‹ETæ•°æ®æ ¡å‡†

---

## é™„å½•F: æ€§èƒ½ä¼˜åŒ–å»ºè®®

### å¤§è§„æ¨¡ç½‘æ ¼è®¡ç®—

```python
# æ–¹æ³•1: åˆ†å—è®¡ç®— (æ¨èç”¨äº>10000ç½‘æ ¼)
def process_chunk(chunk):
    return petcr.calculate_bgcr_et(**chunk)

from multiprocessing import Pool
with Pool(processes=8) as pool:
    results = pool.map(process_chunk, data_chunks)

# æ–¹æ³•2: Daskå¹¶è¡Œ
import dask.array as da
rn_dask = da.from_array(rn_array, chunks=(12, 100, 100))
results = petcr.calculate_bgcr_et(net_radiation=rn_dask, ...)

# æ–¹æ³•3: NumbaåŠ é€Ÿï¼ˆé«˜çº§ï¼‰
from numba import jit
@jit(nopython=True)
def fast_bgcr(...):
    # è‡ªå®šä¹‰åŠ é€Ÿç‰ˆæœ¬
```

---

<!-- _class: lead -->

# æ¼”è®²è€…å¤‡æ³¨å®Œæ•´ç‰ˆ
# Full Speaker Notes

è¯¦è§å•ç‹¬çš„æ¼”è®²è€…å¤‡æ³¨æ–‡æ¡£
See separate speaker notes document

**æ–‡ä»¶**: `PET-CR_Teaching_Presentation_Notes.md`

---

<!-- _class: lead -->

# ç»“æŸ
# End

**å†æ¬¡æ„Ÿè°¢ï¼**
**Thank you again!**

ğŸŒ è®©æˆ‘ä»¬ä¸€èµ·æ¨åŠ¨è’¸æ•£å‘ç ”ç©¶çš„å‘å±•
ğŸŒ Let's advance evapotranspiration research together

---
